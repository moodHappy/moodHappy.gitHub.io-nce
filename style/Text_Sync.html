<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>GitHub åŒæ­¥åŠ©æ‰‹</title>
  <style>
    :root {
      --primary-bg: #f9f9f9;
      --secondary-bg: #fff;
      --text-color: #222;
      --border-color: #ccc;
      --button-primary: #4CAF50;
      --button-copy: #2196F3;
      --button-delete: #f44336;
      --shadow: rgba(0,0,0,0.1);
      --modal-bg: rgba(0,0,0,0.5);
      --status-color: #444;
    }

    /* æŠ¤çœ¼ä¸»é¢˜ */
    [data-theme="dark"] {
      --primary-bg: #1a1a1a;
      --secondary-bg: #2d2d2d;
      --text-color: #e0e0e0;
      --border-color: #555;
      --button-primary: #45a049;
      --button-copy: #1976D2;
      --button-delete: #d32f2f;
      --shadow: rgba(255,255,255,0.1);
      --modal-bg: rgba(0,0,0,0.8);
      --status-color: #bbb;
    }

    [data-theme="sepia"] {
      --primary-bg: #f4f1e8;
      --secondary-bg: #faf8f1;
      --text-color: #5c4b37;
      --border-color: #d4c5a9;
      --button-primary: #8b7355;
      --button-copy: #6b5b73;
      --button-delete: #a0616a;
      --shadow: rgba(92,75,55,0.1);
      --modal-bg: rgba(92,75,55,0.5);
      --status-color: #7a6b4d;
    }

    [data-theme="green"] {
      --primary-bg: #f0f4f0;
      --secondary-bg: #f8faf8;
      --text-color: #2d4a2d;
      --border-color: #c8d4c8;
      --button-primary: #5d7c5d;
      --button-copy: #4a6b7c;
      --button-delete: #7c5d5d;
      --shadow: rgba(45,74,45,0.1);
      --modal-bg: rgba(45,74,45,0.5);
      --status-color: #5d7c5d;
    }

    [data-theme="blue"] {
      --primary-bg: #f0f4f8;
      --secondary-bg: #f8fafc;
      --text-color: #2d3748;
      --border-color: #cbd5e0;
      --button-primary: #4299e1;
      --button-copy: #3182ce;
      --button-delete: #e53e3e;
      --shadow: rgba(45,55,72,0.1);
      --modal-bg: rgba(45,55,72,0.5);
      --status-color: #4a5568;
    }

    body {
      font-family: var(--font-family, 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif);
      font-size: var(--font-size, 16px);
      line-height: var(--line-height, 1.6);
      padding: 1em;
      background: var(--primary-bg);
      color: var(--text-color);
      transition: all 0.3s ease;
      margin: 0;
    }

    /* å­—ä½“æ—è®¾ç½® */
    [data-font="system"] { --font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
    [data-font="serif"] { --font-family: 'Times New Roman', Georgia, serif; }
    [data-font="mono"] { --font-family: 'Consolas', 'Monaco', 'Courier New', monospace; }
    [data-font="chinese"] { --font-family: 'PingFang SC', 'Microsoft YaHei', 'å¾®è½¯é›…é»‘', sans-serif; }
    [data-font="mixed"] { --font-family: 'Segoe UI', 'PingFang SC', 'Microsoft YaHei', sans-serif; }

    /* å­—å·è®¾ç½® */
    [data-size="small"] { --font-size: 14px; --line-height: 1.5; }
    [data-size="medium"] { --font-size: 16px; --line-height: 1.6; }
    [data-size="large"] { --font-size: 18px; --line-height: 1.7; }
    [data-size="xlarge"] { --font-size: 20px; --line-height: 1.8; }

    h2 {
      margin-top: 0;
      color: var(--text-color);
      display: flex;
      align-items: center;
      gap: 10px;
    }

    textarea {
      width: 100%;
      min-height: 120px;
      font-size: var(--font-size);
      font-family: var(--font-family);
      line-height: var(--line-height);
      padding: 12px;
      border-radius: 8px;
      border: 1px solid var(--border-color);
      box-sizing: border-box;
      resize: vertical;
      background: var(--secondary-bg);
      color: var(--text-color);
      transition: all 0.3s ease;
    }

    textarea:focus {
      outline: none;
      border-color: var(--button-primary);
      box-shadow: 0 0 0 2px var(--shadow);
    }

    .button-group {
      margin-bottom: 15px;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    button {
      padding: 10px 16px;
      font-size: 14px;
      border-radius: 6px;
      border: none;
      background-color: var(--button-primary);
      color: white;
      cursor: pointer;
      transition: all 0.2s ease;
      font-family: inherit;
    }

    button:hover {
      opacity: 0.9;
      transform: translateY(-1px);
      box-shadow: 0 2px 8px var(--shadow);
    }

    button:active {
      transform: translateY(0);
    }

    button.copy { background-color: var(--button-copy); }
    button.delete { background-color: var(--button-delete); }
    button.settings { background-color: #666; }

    #status {
      margin-top: 15px;
      color: var(--status-color);
      font-size: 14px;
      padding: 8px 12px;
      background: var(--secondary-bg);
      border-radius: 6px;
      border: 1px solid var(--border-color);
      transition: all 0.3s ease;
    }

    #settingsPanel {
      position: fixed;
      top: 0; right: -350px;
      width: 300px;
      height: 100vh;
      background: var(--secondary-bg);
      border-left: 1px solid var(--border-color);
      padding: 20px;
      box-shadow: -2px 0 10px var(--shadow);
      transition: right 0.3s ease;
      z-index: 1000;
      overflow-y: auto;
    }

    #settingsPanel.open {
      right: 0;
    }

    #settingsOverlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: var(--modal-bg);
      z-index: 999;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    #settingsOverlay.open {
      opacity: 1;
      visibility: visible;
    }

    .settings-section {
      margin-bottom: 25px;
      padding-bottom: 20px;
      border-bottom: 1px solid var(--border-color);
    }

    .settings-section:last-child {
      border-bottom: none;
    }

    .settings-section h4 {
      margin: 0 0 15px 0;
      color: var(--text-color);
      font-size: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .settings-option {
      margin-bottom: 10px;
    }

    .settings-option label {
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      padding: 8px;
      border-radius: 6px;
      transition: background 0.2s ease;
    }

    .settings-option label:hover {
      background: var(--primary-bg);
    }

    .settings-option input[type="radio"] {
      margin: 0;
    }

    #tokenModal {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: var(--modal-bg);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1001;
    }

    #tokenModalContent {
      background: var(--secondary-bg);
      color: var(--text-color);
      padding: 25px;
      border-radius: 12px;
      max-width: 90%;
      width: 400px;
      box-shadow: 0 10px 30px var(--shadow);
    }

    #tokenModalContent h3 {
      margin-top: 0;
      color: var(--text-color);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    #tokenModalContent input {
      width: 100%;
      padding: 12px;
      margin: 15px 0;
      font-size: 16px;
      border-radius: 6px;
      border: 1px solid var(--border-color);
      background: var(--primary-bg);
      color: var(--text-color);
      box-sizing: border-box;
    }

    article.immersive-content {
      display: block;
      background: var(--secondary-bg);
      padding: 20px;
      margin-top: 15px;
      border-radius: 8px;
      border: 1px solid var(--border-color);
      line-height: var(--line-height);
      font-size: var(--font-size);
      font-family: var(--font-family);
      color: var(--text-color);
      transition: all 0.3s ease;
      box-shadow: 0 2px 8px var(--shadow);
    }

    article.immersive-content p {
      margin-bottom: 1em;
      white-space: pre-wrap;
    }

    article.immersive-content p:last-child {
      margin-bottom: 0;
    }

    .word-count {
      font-size: 12px;
      color: var(--status-color);
      text-align: right;
      margin-top: 5px;
      opacity: 0.7;
    }

    @media (max-width: 768px) {
      #settingsPanel {
        width: 100%;
        right: -100%;
      }
      
      /* --- ä¿®å¤ç‚¹ 1: åœ¨ç§»åŠ¨ç«¯æ ·å¼ä¸­æ˜ç¡®å®šä¹‰ .open çŠ¶æ€ --- */
      #settingsPanel.open {
        right: 0;
      }

      .button-group {
        flex-direction: column;
      }

      button {
        width: 100%;
      }
    }

    /* æ»šåŠ¨æ¡ç¾åŒ– */
    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: var(--primary-bg);
    }

    ::-webkit-scrollbar-thumb {
      background: var(--border-color);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--status-color);
    }
  </style>
</head>
<body data-theme="light" data-font="mixed" data-size="medium">
  <h2>
    ğŸ“¤ GitHub åŒæ­¥åŠ©æ‰‹
    <div style="margin-left: auto;">
      <button id="settingsBtn" class="settings">âš™ï¸ è®¾ç½®</button>
    </div>
  </h2>

  <div class="button-group">
    <button onclick="submitContent()">âœ… æäº¤</button>
    <button class="delete" onclick="deleteContent()">ğŸ—‘ï¸ åˆ é™¤</button>
    <button class="copy" onclick="copyContent()">ğŸ“‹ å¤åˆ¶</button>
    <button onclick="toggleEditMode()" id="editToggle" style="background: #ff9800;">âœï¸ ç¼–è¾‘</button>
  </div>

  <textarea id="inputContent" placeholder="è¯·è¾“å…¥è‹±æ–‡æ–‡æœ¬ï¼ˆæ”¯æŒå¤šæ®µï¼Œæ¯æ®µç”¨ç©ºè¡Œåˆ†éš”ï¼‰..."></textarea>
  <div class="word-count" id="wordCount">0 å­—ç¬¦ | 0 å•è¯</div>

  <article id="renderedContent" class="immersive-content" style="display:none;"></article>

  <div id="status">â³ æ­£åœ¨åŠ è½½ GitHub å†…å®¹...</div>

  <div id="settingsOverlay" onclick="closeSettings()"></div>
  <div id="settingsPanel">
    <div class="settings-section">
      <h4>ğŸ¨ æŠ¤çœ¼ä¸»é¢˜</h4>
      <div class="settings-option">
        <label><input type="radio" name="theme" value="light" checked> ğŸŒ æ˜äº®æ¨¡å¼</label>
      </div>
      <div class="settings-option">
        <label><input type="radio" name="theme" value="dark"> ğŸŒ™ æ·±è‰²æ¨¡å¼</label>
      </div>
      <div class="settings-option">
        <label><input type="radio" name="theme" value="sepia"> ğŸ“œ æŠ¤çœ¼æ£•è‰²</label>
      </div>
      <div class="settings-option">
        <label><input type="radio" name="theme" value="green"> ğŸŒ¿ æŠ¤çœ¼ç»¿è‰²</label>
      </div>
      <div class="settings-option">
        <label><input type="radio" name="theme" value="blue"> ğŸ’™ æŠ¤çœ¼è“è‰²</label>
      </div>
    </div>

    <div class="settings-section">
      <h4>ğŸ”¤ å­—ä½“é€‰æ‹©</h4>
      <div class="settings-option">
        <label><input type="radio" name="font" value="mixed" checked> ğŸŒ ä¸­è‹±æ··æ’</label>
      </div>
      <div class="settings-option">
        <label><input type="radio" name="font" value="system"> ğŸ’» ç³»ç»Ÿé»˜è®¤</label>
      </div>
      <div class="settings-option">
        <label><input type="radio" name="font" value="serif"> ğŸ“– è¡¬çº¿å­—ä½“</label>
      </div>
      <div class="settings-option">
        <label><input type="radio" name="font" value="mono"> âŒ¨ï¸ ç­‰å®½å­—ä½“</label>
      </div>
      <div class="settings-option">
        <label><input type="radio" name="font" value="chinese"> ğŸ‡¨ğŸ‡³ ä¸­æ–‡ä¼˜å…ˆ</label>
      </div>
    </div>

    <div class="settings-section">
      <h4>ğŸ“ å­—å·å¤§å°</h4>
      <div class="settings-option">
        <label><input type="radio" name="size" value="small"> ğŸ” å°å· (14px)</label>
      </div>
      <div class="settings-option">
        <label><input type="radio" name="size" value="medium" checked> ğŸ“ ä¸­å· (16px)</label>
      </div>
      <div class="settings-option">
        <label><input type="radio" name="size" value="large"> ğŸ“– å¤§å· (18px)</label>
      </div>
      <div class="settings-option">
        <label><input type="radio" name="size" value="xlarge"> ğŸ” ç‰¹å¤§ (20px)</label>
      </div>
    </div>

    <div class="settings-section">
      <h4>ğŸ” è´¦æˆ·ç®¡ç†</h4>
      <button onclick="resetToken()" style="width: 100%; background: #ff9800;">ğŸ”„ é‡è®¾ GitHub Token</button>
    </div>

    <div class="settings-section">
      <h4>â„¹ï¸ ä½¿ç”¨è¯´æ˜</h4>
      <p style="font-size: 12px; line-height: 1.4; color: var(--status-color); margin: 0;">
        â€¢ æ”¯æŒå®æ—¶å­—æ•°ç»Ÿè®¡<br>
        â€¢ è‡ªåŠ¨ä¿å­˜è®¾ç½®åå¥½<br>
        â€¢ æ”¯æŒé”®ç›˜å¿«æ·é”®<br>
        â€¢ Ctrl+S å¿«é€Ÿæäº¤<br>
        â€¢ Esc å…³é—­è®¾ç½®é¢æ¿
      </p>
    </div>
  </div>

  <div id="tokenModal" style="display:none;">
    <div id="tokenModalContent">
      <h3>ğŸ” è¯·è¾“å…¥ä½ çš„ GitHub Tokenï¼š</h3>
      <input type="password" id="tokenInput" placeholder="ghp_xxx æˆ– github_pat_xxx" />
      <button style="margin-top:15px; width: 100%;" onclick="saveToken()">ğŸ’¾ ä¿å­˜ Token</button>
    </div>
  </div>

  <script>
    const GITHUB_USERNAME = "moodHappy";
    const GITHUB_REPO = "HelloWorld";
    const WORD_FILE_PATH_GITHUB = "Notes/transfer.txt";

    let GITHUB_TOKEN = localStorage.getItem("github_token") || null;
    const apiUrl = `https://api.github.com/repos/${GITHUB_USERNAME}/${GITHUB_REPO}/contents/${WORD_FILE_PATH_GITHUB}`;

    const textarea = document.getElementById("inputContent");
    const renderedDiv = document.getElementById("renderedContent");
    const wordCountDiv = document.getElementById("wordCount");
    const editToggle = document.getElementById("editToggle");

    let isRenderMode = false;

    // åˆå§‹åŒ–è®¾ç½®
    function initSettings() {
      const savedTheme = localStorage.getItem("app_theme") || "light";
      const savedFont = localStorage.getItem("app_font") || "mixed";
      const savedSize = localStorage.getItem("app_size") || "medium";

      applySettings(savedTheme, savedFont, savedSize);
      updateRadioButtons("theme", savedTheme);
      updateRadioButtons("font", savedFont);
      updateRadioButtons("size", savedSize);
    }

    function updateRadioButtons(name, value) {
      const radio = document.querySelector(`input[name="${name}"][value="${value}"]`);
      if (radio) radio.checked = true;
    }

    function applySettings(theme, font, size) {
      document.body.setAttribute("data-theme", theme);
      document.body.setAttribute("data-font", font);
      document.body.setAttribute("data-size", size);
    }

    // è®¾ç½®é¢æ¿æ§åˆ¶
    function toggleSettings() {
      const panel = document.getElementById("settingsPanel");
      const overlay = document.getElementById("settingsOverlay");
      const isOpen = panel.classList.contains("open");

      if (isOpen) {
        closeSettings();
      } else {
        panel.classList.add("open");
        overlay.classList.add("open");
      }
    }

    function closeSettings() {
      document.getElementById("settingsPanel").classList.remove("open");
      document.getElementById("settingsOverlay").classList.remove("open");
    }

    // å­—æ•°ç»Ÿè®¡
    function updateWordCount() {
      const text = textarea.value;
      const charCount = text.length;
      const wordCount = text.trim() ? text.trim().split(/\s+/).length : 0;
      wordCountDiv.textContent = `${charCount} å­—ç¬¦ | ${wordCount} å•è¯`;
    }

    // ç¼–è¾‘æ¨¡å¼åˆ‡æ¢
    function toggleEditMode() {
      if (isRenderMode) {
        editMode();
      } else if (textarea.value.trim()) {
        renderMode(textarea.value);
      }
    }

    function ensureToken() {
      if (!GITHUB_TOKEN) {
        document.getElementById("tokenModal").style.display = "flex";
      }
    }

    function saveToken() {
      const token = document.getElementById("tokenInput").value.trim();
      if (!token.startsWith("ghp_") && !token.startsWith("github_pat_")) {
        alert("è¯·è¾“å…¥æœ‰æ•ˆçš„ GitHub Tokenï¼");
        return;
      }
      localStorage.setItem("github_token", token);
      GITHUB_TOKEN = token;
      document.getElementById("tokenModal").style.display = "none";
      document.getElementById("tokenInput").value = "";
      loadContent();
    }

    function resetToken() {
      localStorage.removeItem("github_token");
      GITHUB_TOKEN = null;
      closeSettings();
      ensureToken();
    }

    function getHeaders() {
      return {
        Authorization: `Bearer ${GITHUB_TOKEN}`,
        Accept: "application/vnd.github.v3+json"
      };
    }

    async function getCurrentFileShaAndContent() {
      try {
        const res = await fetch(apiUrl, { headers: getHeaders() });
        if (!res.ok) throw new Error(`GitHub çŠ¶æ€ç  ${res.status}`);
        const data = await res.json();
        const decoded = decodeURIComponent(escape(atob(data.content)));
        return { sha: data.sha, content: decoded };
      } catch (err) {
        console.warn("è¯»å–å¤±è´¥ï¼š", err.message);
        return { sha: null, content: "" };
      }
    }

    async function submitContent() {
      const content = textarea.value.trim();
      if (!content) return alert("è¯·è¾“å…¥å†…å®¹å†æäº¤ï¼");
      document.getElementById("status").textContent = "ğŸ”„ æ­£åœ¨æäº¤åˆ° GitHub...";

      try {
        const { sha } = await getCurrentFileShaAndContent();
        const encodedContent = btoa(unescape(encodeURIComponent(content)));

        const res = await fetch(apiUrl, {
          method: "PUT",
          headers: {
            ...getHeaders(),
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            message: "æ›´æ–° transfer.txt",
            content: encodedContent,
            committer: { name: "AutoCommit", email: "bot@example.com" },
            ...(sha ? { sha } : {})
          })
        });

        if (res.ok) {
          renderMode(content);
          document.getElementById("status").textContent = "âœ… æäº¤æˆåŠŸï¼Œæ®µè½å·²æ¸²æŸ“ã€‚";
        } else {
          const errorData = await res.json();
          document.getElementById("status").textContent = "âŒ æäº¤å¤±è´¥ï¼š" + (errorData.message || "æœªçŸ¥é”™è¯¯");
        }
      } catch (err) {
        document.getElementById("status").textContent = "âŒ ç½‘ç»œé”™è¯¯ï¼š" + err.message;
      }
    }

    async function deleteContent() {
      if (!confirm("ç¡®å®šè¦æ¸…ç©º GitHub æ–‡ä»¶å—ï¼Ÿ")) return;

      document.getElementById("status").textContent = "ğŸ—‘ï¸ æ­£åœ¨æ¸…ç©º GitHub æ–‡ä»¶...";

      try {
        const { sha } = await getCurrentFileShaAndContent();
        if (!sha) {
          textarea.value = "";
          editMode();
          updateWordCount();
          document.getElementById("status").textContent = "âœ… æ–‡ä»¶å·²ä¸ºç©ºã€‚";
          return;
        }

        const res = await fetch(apiUrl, {
          method: "PUT",
          headers: {
            ...getHeaders(),
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            message: "æ¸…ç©º transfer.txt",
            content: btoa(""),
            sha,
            committer: { name: "AutoCommit", email: "bot@example.com" }
          })
        });

        if (res.ok) {
          textarea.value = "";
          editMode();
          updateWordCount();
          document.getElementById("status").textContent = "âœ… GitHub å†…å®¹å·²æ¸…ç©ºã€‚";
        } else {
          const errorData = await res.json();
          document.getElementById("status").textContent = "âŒ åˆ é™¤å¤±è´¥ï¼š" + (errorData.message || "æœªçŸ¥é”™è¯¯");
        }
      } catch (err) {
        document.getElementById("status").textContent = "âŒ ç½‘ç»œé”™è¯¯ï¼š" + err.message;
      }
    }

    function copyContent() {
      const content = isRenderMode ? renderedDiv.textContent : textarea.value;
      if (!content.trim()) {
        document.getElementById("status").textContent = "âš ï¸ æ²¡æœ‰å†…å®¹å¯å¤åˆ¶ã€‚";
        return;
      }

      navigator.clipboard.writeText(content).then(() => {
        document.getElementById("status").textContent = "ğŸ“‹ å†…å®¹å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ã€‚";
      }).catch(() => {
        document.getElementById("status").textContent = "âŒ å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨é€‰æ‹©å¤åˆ¶ã€‚";
      });
    }

    function renderMode(text) {
      renderedDiv.innerHTML = "";
      const paragraphs = text.split(/\n\s*\n/);
      for (const para of paragraphs) {
        if (para.trim()) {
          const p = document.createElement("p");
          p.textContent = para.trim();
          renderedDiv.appendChild(p);
        }
      }
      renderedDiv.style.display = "block";
      textarea.style.display = "none";
      wordCountDiv.style.display = "none";
      editToggle.textContent = "âœï¸ ç¼–è¾‘";
      editToggle.style.background = "#ff9800";
      isRenderMode = true;
    }

    function editMode() {
      textarea.style.display = "block";
      renderedDiv.style.display = "none";
      wordCountDiv.style.display = "block";
      editToggle.textContent = "ğŸ‘ï¸ é¢„è§ˆ";
      editToggle.style.background = "#9c27b0";
      isRenderMode = false;
      textarea.focus();
    }

    async function loadContent() {
      try {
        const { content } = await getCurrentFileShaAndContent();
        textarea.value = content;
        updateWordCount();

        if (content.trim()) {
          renderMode(content);
        } else {
          editMode();
        }
        document.getElementById("status").textContent = "âœ… GitHub å†…å®¹å·²åŠ è½½ã€‚";
      } catch (err) {
        document.getElementById("status").textContent = "âŒ åŠ è½½å¤±è´¥ï¼š" + err.message;
        editMode();
      }
    }

    // äº‹ä»¶ç›‘å¬
    textarea.addEventListener("input", updateWordCount);

    // --- ä¿®å¤ç‚¹ 2 (æ¨è): ç»‘å®šç‚¹å‡»äº‹ä»¶ ---
    document.getElementById('settingsBtn').addEventListener('click', toggleSettings);

    // è®¾ç½®å˜æ›´ç›‘å¬
    document.addEventListener("change", (e) => {
      if (e.target.type === "radio") {
        const name = e.target.name;
        const value = e.target.value;

        if (name === "theme") {
          localStorage.setItem("app_theme", value);
          document.body.setAttribute("data-theme", value);
        } else if (name === "font") {
          localStorage.setItem("app_font", value);
          document.body.setAttribute("data-font", value);
        } else if (name === "size") {
          localStorage.setItem("app_size", value);
          document.body.setAttribute("data-size", value);
        }
      }
    });

    // é”®ç›˜å¿«æ·é”®
    document.addEventListener("keydown", (e) => {
      if (e.ctrlKey && e.key === "s") {
        e.preventDefault();
        submitContent();
      } else if (e.key === "Escape") {
        closeSettings();
      }
    });

    // Token è¾“å…¥æ¡†å›è½¦æäº¤
    document.getElementById("tokenInput").addEventListener("keydown", (e) => {
      if (e.key === "Enter") {
        saveToken();
      }
    });

    // åˆå§‹åŒ–
    window.onload = () => {
      initSettings();
      ensureToken();
      if (GITHUB_TOKEN) loadContent();
      updateWordCount();
    };
  </script>
</body>
</html>
