<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>GitHub ÂêåÊ≠•Âä©Êâã</title>
  <style>
    :root {
      --primary-bg: #f9f9f9;
      --secondary-bg: #fff;
      --text-color: #222;
      --border-color: #ccc;
      --button-primary: #4CAF50;
      --button-copy: #2196F3;
      --button-delete: #f44336;
      --shadow: rgba(0,0,0,0.1);
      --modal-bg: rgba(0,0,0,0.5);
      --status-color: #444;
    }

    /* Êä§Áúº‰∏ªÈ¢ò */
    [data-theme="dark"] {
      --primary-bg: #1a1a1a;
      --secondary-bg: #2d2d2d;
      --text-color: #e0e0e0;
      --border-color: #555;
      --button-primary: #45a049;
      --button-copy: #1976D2;
      --button-delete: #d32f2f;
      --shadow: rgba(255,255,255,0.1);
      --modal-bg: rgba(0,0,0,0.8);
      --status-color: #bbb;
    }

    [data-theme="sepia"] {
      --primary-bg: #f4f1e8;
      --secondary-bg: #faf8f1;
      --text-color: #5c4b37;
      --border-color: #d4c5a9;
      --button-primary: #8b7355;
      --button-copy: #6b5b73;
      --button-delete: #a0616a;
      --shadow: rgba(92,75,55,0.1);
      --modal-bg: rgba(92,75,55,0.5);
      --status-color: #7a6b4d;
    }

    [data-theme="green"] {
      --primary-bg: #f0f4f0;
      --secondary-bg: #f8faf8;
      --text-color: #2d4a2d;
      --border-color: #c8d4c8;
      --button-primary: #5d7c5d;
      --button-copy: #4a6b7c;
      --button-delete: #7c5d5d;
      --shadow: rgba(45,74,45,0.1);
      --modal-bg: rgba(45,74,45,0.5);
      --status-color: #5d7c5d;
    }

    [data-theme="blue"] {
      --primary-bg: #f0f4f8;
      --secondary-bg: #f8fafc;
      --text-color: #2d3748;
      --border-color: #cbd5e0;
      --button-primary: #4299e1;
      --button-copy: #3182ce;
      --button-delete: #e53e3e;
      --shadow: rgba(45,55,72,0.1);
      --modal-bg: rgba(45,55,72,0.5);
      --status-color: #4a5568;
    }

    body {
      font-family: var(--font-family, 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif);
      font-size: var(--font-size, 16px);
      line-height: var(--line-height, 1.6);
      padding: 1em;
      background: var(--primary-bg);
      color: var(--text-color);
      transition: all 0.3s ease;
      margin: 0;
    }

    /* Â≠ó‰ΩìÊóèËÆæÁΩÆ */
    [data-font="system"] { --font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
    [data-font="serif"] { --font-family: 'Times New Roman', Georgia, serif; }
    [data-font="mono"] { --font-family: 'Consolas', 'Monaco', 'Courier New', monospace; }
    [data-font="chinese"] { --font-family: 'PingFang SC', 'Microsoft YaHei', 'ÂæÆËΩØÈõÖÈªë', sans-serif; }
    [data-font="mixed"] { --font-family: 'Segoe UI', 'PingFang SC', 'Microsoft YaHei', sans-serif; }

    /* Â≠óÂè∑ËÆæÁΩÆ */
    [data-size="small"] { --font-size: 14px; --line-height: 1.5; }
    [data-size="medium"] { --font-size: 16px; --line-height: 1.6; }
    [data-size="large"] { --font-size: 18px; --line-height: 1.7; }
    [data-size="xlarge"] { --font-size: 20px; --line-height: 1.8; }

    h2 {
      margin-top: 0;
      color: var(--text-color);
      display: flex;
      align-items: center;
      gap: 10px;
    }

    textarea {
      width: 100%;
      min-height: 120px;
      font-size: var(--font-size);
      font-family: var(--font-family);
      line-height: var(--line-height);
      padding: 12px;
      border-radius: 8px;
      border: 1px solid var(--border-color);
      box-sizing: border-box;
      resize: vertical;
      background: var(--secondary-bg);
      color: var(--text-color);
      transition: all 0.3s ease;
    }

    textarea:focus {
      outline: none;
      border-color: var(--button-primary);
      box-shadow: 0 0 0 2px var(--shadow);
    }

    .button-group {
      margin-bottom: 15px;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    button {
      padding: 10px 16px;
      font-size: 14px;
      border-radius: 6px;
      border: none;
      background-color: var(--button-primary);
      color: white;
      cursor: pointer;
      transition: all 0.2s ease;
      font-family: inherit;
    }

    button:hover {
      opacity: 0.9;
      transform: translateY(-1px);
      box-shadow: 0 2px 8px var(--shadow);
    }

    button:active {
      transform: translateY(0);
    }

    button.copy { background-color: var(--button-copy); }
    button.delete { background-color: var(--button-delete); }
    button.settings { background-color: #666; }

    #status {
      margin-top: 15px;
      color: var(--status-color);
      font-size: 14px;
      padding: 8px 12px;
      background: var(--secondary-bg);
      border-radius: 6px;
      border: 1px solid var(--border-color);
      transition: all 0.3s ease;
    }

    #settingsPanel {
      position: fixed;
      top: 0; right: -350px;
      width: 300px;
      height: 100vh;
      background: var(--secondary-bg);
      border-left: 1px solid var(--border-color);
      padding: 20px;
      box-shadow: -2px 0 10px var(--shadow);
      transition: right 0.3s ease;
      z-index: 1000;
      overflow-y: auto;
    }

    #settingsPanel.open {
      right: 0;
    }

    #settingsOverlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: var(--modal-bg);
      z-index: 999;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    #settingsOverlay.open {
      opacity: 1;
      visibility: visible;
    }

    .settings-section {
      margin-bottom: 25px;
      padding-bottom: 20px;
      border-bottom: 1px solid var(--border-color);
    }

    .settings-section:last-child {
      border-bottom: none;
    }

    .settings-section h4 {
      margin: 0 0 15px 0;
      color: var(--text-color);
      font-size: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .settings-option {
      margin-bottom: 10px;
    }

    .settings-option label {
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      padding: 8px;
      border-radius: 6px;
      transition: background 0.2s ease;
    }

    .settings-option label:hover {
      background: var(--primary-bg);
    }

    .settings-option input[type="radio"] {
      margin: 0;
    }

    #tokenModal {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: var(--modal-bg);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1001;
    }

    #tokenModalContent {
      background: var(--secondary-bg);
      color: var(--text-color);
      padding: 25px;
      border-radius: 12px;
      max-width: 90%;
      width: 400px;
      box-shadow: 0 10px 30px var(--shadow);
    }

    #tokenModalContent h3 {
      margin-top: 0;
      color: var(--text-color);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    #tokenModalContent input {
      width: 100%;
      padding: 12px;
      margin: 15px 0;
      font-size: 16px;
      border-radius: 6px;
      border: 1px solid var(--border-color);
      background: var(--primary-bg);
      color: var(--text-color);
      box-sizing: border-box;
    }

    article.immersive-content {
      display: block;
      background: var(--secondary-bg);
      padding: 20px;
      margin-top: 15px;
      border-radius: 8px;
      border: 1px solid var(--border-color);
      line-height: var(--line-height);
      font-size: var(--font-size);
      font-family: var(--font-family);
      color: var(--text-color);
      transition: all 0.3s ease;
      box-shadow: 0 2px 8px var(--shadow);
    }

    article.immersive-content p {
      margin-bottom: 1em;
      white-space: pre-wrap;
    }

    article.immersive-content p:last-child {
      margin-bottom: 0;
    }

    .word-count {
      font-size: 12px;
      color: var(--status-color);
      text-align: right;
      margin-top: 5px;
      opacity: 0.7;
    }

    @media (max-width: 768px) {
      #settingsPanel {
        width: 100%;
        right: -100%;
      }
      
      /* --- ‰øÆÂ§çÁÇπ 1: Âú®ÁßªÂä®Á´ØÊ†∑Âºè‰∏≠ÊòéÁ°ÆÂÆö‰πâ .open Áä∂ÊÄÅ --- */
      #settingsPanel.open {
        right: 0;
      }

      .button-group {
        flex-direction: column;
      }

      button {
        width: 100%;
      }
    }

    /* ÊªöÂä®Êù°ÁæéÂåñ */
    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: var(--primary-bg);
    }

    ::-webkit-scrollbar-thumb {
      background: var(--border-color);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--status-color);
    }
  </style>
</head>
<body data-theme="light" data-font="mixed" data-size="medium">
  <h2>
    üì§ GitHub ÂêåÊ≠•Âä©Êâã
    <div style="margin-left: auto;">
      <button id="settingsBtn" class="settings">‚öôÔ∏è ËÆæÁΩÆ</button>
    </div>
  </h2>

  <div class="button-group">
    <button onclick="submitContent()">‚úÖ Êèê‰∫§</button>
    <button class="delete" onclick="deleteContent()">üóëÔ∏è Âà†Èô§</button>
    <button class="copy" onclick="copyContent()">üìã Â§çÂà∂</button>
    <button onclick="toggleEditMode()" id="editToggle" style="background: #ff9800;">‚úèÔ∏è ÁºñËæë</button>
  </div>

  <textarea id="inputContent" placeholder="ËØ∑ËæìÂÖ•Ëã±ÊñáÊñáÊú¨ÔºàÊîØÊåÅÂ§öÊÆµÔºåÊØèÊÆµÁî®Á©∫Ë°åÂàÜÈöîÔºâ..."></textarea>
  <div class="word-count" id="wordCount">0 Â≠óÁ¨¶ | 0 ÂçïËØç</div>

  <article id="renderedContent" class="immersive-content" style="display:none;"></article>

  <div id="status">‚è≥ Ê≠£Âú®Âä†ËΩΩ GitHub ÂÜÖÂÆπ...</div>

  <div id="settingsOverlay" onclick="closeSettings()"></div>
  <div id="settingsPanel">
    <div class="settings-section">
      <h4>üé® Êä§Áúº‰∏ªÈ¢ò</h4>
      <div class="settings-option">
        <label><input type="radio" name="theme" value="light" checked> üåû Êòé‰∫ÆÊ®°Âºè</label>
      </div>
      <div class="settings-option">
        <label><input type="radio" name="theme" value="dark"> üåô Ê∑±Ëâ≤Ê®°Âºè</label>
      </div>
      <div class="settings-option">
        <label><input type="radio" name="theme" value="sepia"> üìú Êä§ÁúºÊ£ïËâ≤</label>
      </div>
      <div class="settings-option">
        <label><input type="radio" name="theme" value="green"> üåø Êä§ÁúºÁªøËâ≤</label>
      </div>
      <div class="settings-option">
        <label><input type="radio" name="theme" value="blue"> üíô Êä§ÁúºËìùËâ≤</label>
      </div>
    </div>

    <div class="settings-section">
      <h4>üî§ Â≠ó‰ΩìÈÄâÊã©</h4>
      <div class="settings-option">
        <label><input type="radio" name="font" value="mixed" checked> üåê ‰∏≠Ëã±Ê∑∑Êéí</label>
      </div>
      <div class="settings-option">
        <label><input type="radio" name="font" value="system"> üíª Á≥ªÁªüÈªòËÆ§</label>
      </div>
      <div class="settings-option">
        <label><input type="radio" name="font" value="serif"> üìñ Ë°¨Á∫øÂ≠ó‰Ωì</label>
      </div>
      <div class="settings-option">
        <label><input type="radio" name="font" value="mono"> ‚å®Ô∏è Á≠âÂÆΩÂ≠ó‰Ωì</label>
      </div>
      <div class="settings-option">
        <label><input type="radio" name="font" value="chinese"> üá®üá≥ ‰∏≠Êñá‰ºòÂÖà</label>
      </div>
    </div>

    <div class="settings-section">
      <h4>üìè Â≠óÂè∑Â§ßÂ∞è</h4>
      <div class="settings-option">
        <label><input type="radio" name="size" value="small"> üîç Â∞èÂè∑ (14px)</label>
      </div>
      <div class="settings-option">
        <label><input type="radio" name="size" value="medium" checked> üìù ‰∏≠Âè∑ (16px)</label>
      </div>
      <div class="settings-option">
        <label><input type="radio" name="size" value="large"> üìñ Â§ßÂè∑ (18px)</label>
      </div>
      <div class="settings-option">
        <label><input type="radio" name="size" value="xlarge"> üîé ÁâπÂ§ß (20px)</label>
      </div>
    </div>

    <div class="settings-section">
      <h4>üîê Ë¥¶Êà∑ÁÆ°ÁêÜ</h4>
      <button onclick="resetToken()" style="width: 100%; background: #ff9800;">üîÑ ÈáçËÆæ GitHub Token</button>
    </div>

    <div class="settings-section">
      <h4>‚ÑπÔ∏è ‰ΩøÁî®ËØ¥Êòé</h4>
      <p style="font-size: 12px; line-height: 1.4; color: var(--status-color); margin: 0;">
        ‚Ä¢ ÊîØÊåÅÂÆûÊó∂Â≠óÊï∞ÁªüËÆ°<br>
        ‚Ä¢ Ëá™Âä®‰øùÂ≠òËÆæÁΩÆÂÅèÂ•Ω<br>
        ‚Ä¢ ÊîØÊåÅÈîÆÁõòÂø´Êç∑ÈîÆ<br>
        ‚Ä¢ Ctrl+S Âø´ÈÄüÊèê‰∫§<br>
        ‚Ä¢ Esc ÂÖ≥Èó≠ËÆæÁΩÆÈù¢Êùø
      </p>
    </div>
  </div>

  <div id="tokenModal" style="display:none;">
    <div id="tokenModalContent">
      <h3>üîê ËØ∑ËæìÂÖ•‰Ω†ÁöÑ GitHub TokenÔºö</h3>
      <input type="password" id="tokenInput" placeholder="ghp_xxx Êàñ github_pat_xxx" />
      <button style="margin-top:15px; width: 100%;" onclick="saveToken()">üíæ ‰øùÂ≠ò Token</button>
    </div>
  </div>

  <script>
    const GITHUB_USERNAME = "moodHappy";
    const GITHUB_REPO = "HelloWorld";
    const WORD_FILE_PATH_GITHUB = "Notes/transfer.txt";

    let GITHUB_TOKEN = localStorage.getItem("github_token") || null;
    const apiUrl = `https://api.github.com/repos/${GITHUB_USERNAME}/${GITHUB_REPO}/contents/${WORD_FILE_PATH_GITHUB}`;

    const textarea = document.getElementById("inputContent");
    const renderedDiv = document.getElementById("renderedContent");
    const wordCountDiv = document.getElementById("wordCount");
    const editToggle = document.getElementById("editToggle");

    let isRenderMode = false;

    // ÂàùÂßãÂåñËÆæÁΩÆ
    function initSettings() {
      const savedTheme = localStorage.getItem("app_theme") || "light";
      const savedFont = localStorage.getItem("app_font") || "mixed";
      const savedSize = localStorage.getItem("app_size") || "medium";

      applySettings(savedTheme, savedFont, savedSize);
      updateRadioButtons("theme", savedTheme);
      updateRadioButtons("font", savedFont);
      updateRadioButtons("size", savedSize);
    }

    function updateRadioButtons(name, value) {
      const radio = document.querySelector(`input[name="${name}"][value="${value}"]`);
      if (radio) radio.checked = true;
    }

    function applySettings(theme, font, size) {
      document.body.setAttribute("data-theme", theme);
      document.body.setAttribute("data-font", font);
      document.body.setAttribute("data-size", size);
    }

    // ËÆæÁΩÆÈù¢ÊùøÊéßÂà∂
    function toggleSettings() {
      const panel = document.getElementById("settingsPanel");
      const overlay = document.getElementById("settingsOverlay");
      const isOpen = panel.classList.contains("open");

      if (isOpen) {
        closeSettings();
      } else {
        panel.classList.add("open");
        overlay.classList.add("open");
      }
    }

    function closeSettings() {
      document.getElementById("settingsPanel").classList.remove("open");
      document.getElementById("settingsOverlay").classList.remove("open");
    }

    // Â≠óÊï∞ÁªüËÆ°
    function updateWordCount() {
      const text = textarea.value;
      const charCount = text.length;
      const wordCount = text.trim() ? text.trim().split(/\s+/).length : 0;
      wordCountDiv.textContent = `${charCount} Â≠óÁ¨¶ | ${wordCount} ÂçïËØç`;
    }

    // ÁºñËæëÊ®°ÂºèÂàáÊç¢
    function toggleEditMode() {
      if (isRenderMode) {
        editMode();
      } else if (textarea.value.trim()) {
        renderMode(textarea.value);
      }
    }

    function ensureToken() {
      if (!GITHUB_TOKEN) {
        document.getElementById("tokenModal").style.display = "flex";
      }
    }

    function saveToken() {
      const token = document.getElementById("tokenInput").value.trim();
      if (!token.startsWith("ghp_") && !token.startsWith("github_pat_")) {
        alert("ËØ∑ËæìÂÖ•ÊúâÊïàÁöÑ GitHub TokenÔºÅ");
        return;
      }
      localStorage.setItem("github_token", token);
      GITHUB_TOKEN = token;
      document.getElementById("tokenModal").style.display = "none";
      document.getElementById("tokenInput").value = "";
      loadContent();
    }

    function resetToken() {
      localStorage.removeItem("github_token");
      GITHUB_TOKEN = null;
      closeSettings();
      ensureToken();
    }

    function getHeaders() {
      return {
        Authorization: `Bearer ${GITHUB_TOKEN}`,
        Accept: "application/vnd.github.v3+json"
      };
    }

    async function getCurrentFileShaAndContent() {
      try {
        const res = await fetch(apiUrl, { headers: getHeaders() });
        if (!res.ok) throw new Error(`GitHub Áä∂ÊÄÅÁ†Å ${res.status}`);
        const data = await res.json();
        const decoded = decodeURIComponent(escape(atob(data.content)));
        return { sha: data.sha, content: decoded };
      } catch (err) {
        console.warn("ËØªÂèñÂ§±Ë¥•Ôºö", err.message);
        return { sha: null, content: "" };
      }
    }

    async function submitContent() {
      const content = textarea.value.trim();
      if (!content) return alert("ËØ∑ËæìÂÖ•ÂÜÖÂÆπÂÜçÊèê‰∫§ÔºÅ");
      document.getElementById("status").textContent = "üîÑ Ê≠£Âú®Êèê‰∫§Âà∞ GitHub...";

      try {
        const { sha } = await getCurrentFileShaAndContent();
        const encodedContent = btoa(unescape(encodeURIComponent(content)));

        const res = await fetch(apiUrl, {
          method: "PUT",
          headers: {
            ...getHeaders(),
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            message: "Êõ¥Êñ∞ transfer.txt",
            content: encodedContent,
            committer: { name: "AutoCommit", email: "bot@example.com" },
            ...(sha ? { sha } : {})
          })
        });

        if (res.ok) {
          renderMode(content);
          document.getElementById("status").textContent = "‚úÖ Êèê‰∫§ÊàêÂäüÔºåÊÆµËêΩÂ∑≤Ê∏≤Êüì„ÄÇ";
        } else {
          const errorData = await res.json();
          document.getElementById("status").textContent = "‚ùå Êèê‰∫§Â§±Ë¥•Ôºö" + (errorData.message || "Êú™Áü•ÈîôËØØ");
        }
      } catch (err) {
        document.getElementById("status").textContent = "‚ùå ÁΩëÁªúÈîôËØØÔºö" + err.message;
      }
    }

    async function deleteContent() {
      if (!confirm("Á°ÆÂÆöË¶ÅÊ∏ÖÁ©∫ GitHub Êñá‰ª∂ÂêóÔºü")) return;

      document.getElementById("status").textContent = "üóëÔ∏è Ê≠£Âú®Ê∏ÖÁ©∫ GitHub Êñá‰ª∂...";

      try {
        const { sha } = await getCurrentFileShaAndContent();
        if (!sha) {
          textarea.value = "";
          editMode();
          updateWordCount();
          document.getElementById("status").textContent = "‚úÖ Êñá‰ª∂Â∑≤‰∏∫Á©∫„ÄÇ";
          return;
        }

        const res = await fetch(apiUrl, {
          method: "PUT",
          headers: {
            ...getHeaders(),
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            message: "Ê∏ÖÁ©∫ transfer.txt",
            content: btoa(""),
            sha,
            committer: { name: "AutoCommit", email: "bot@example.com" }
          })
        });

        if (res.ok) {
          textarea.value = "";
          editMode();
          updateWordCount();
          document.getElementById("status").textContent = "‚úÖ GitHub ÂÜÖÂÆπÂ∑≤Ê∏ÖÁ©∫„ÄÇ";
        } else {
          const errorData = await res.json();
          document.getElementById("status").textContent = "‚ùå Âà†Èô§Â§±Ë¥•Ôºö" + (errorData.message || "Êú™Áü•ÈîôËØØ");
        }
      } catch (err) {
        document.getElementById("status").textContent = "‚ùå ÁΩëÁªúÈîôËØØÔºö" + err.message;
      }
    }

    function copyContent() {
      const content = isRenderMode ? renderedDiv.textContent : textarea.value;
      if (!content.trim()) {
        document.getElementById("status").textContent = "‚ö†Ô∏è Ê≤°ÊúâÂÜÖÂÆπÂèØÂ§çÂà∂„ÄÇ";
        return;
      }

      navigator.clipboard.writeText(content).then(() => {
        document.getElementById("status").textContent = "üìã ÂÜÖÂÆπÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø„ÄÇ";
      }).catch(() => {
        document.getElementById("status").textContent = "‚ùå Â§çÂà∂Â§±Ë¥•ÔºåËØ∑ÊâãÂä®ÈÄâÊã©Â§çÂà∂„ÄÇ";
      });
    }

    function renderMode(text) {
      renderedDiv.innerHTML = "";
      const paragraphs = text.split(/\n\s*\n/);
      for (const para of paragraphs) {
        if (para.trim()) {
          const p = document.createElement("p");
          p.textContent = para.trim();
          renderedDiv.appendChild(p);
        }
      }
      renderedDiv.style.display = "block";
      textarea.style.display = "none";
      wordCountDiv.style.display = "none";
      editToggle.textContent = "‚úèÔ∏è ÁºñËæë";
      editToggle.style.background = "#ff9800";
      isRenderMode = true;
    }

    function editMode() {
      textarea.style.display = "block";
      renderedDiv.style.display = "none";
      wordCountDiv.style.display = "block";
      editToggle.textContent = "üëÅÔ∏è È¢ÑËßà";
      editToggle.style.background = "#9c27b0";
      isRenderMode = false;
      textarea.focus();
    }

    async function loadContent() {
      try {
        const { content } = await getCurrentFileShaAndContent();
        textarea.value = content;
        updateWordCount();

        if (content.trim()) {
          renderMode(content);
        } else {
          editMode();
        }
        document.getElementById("status").textContent = "‚úÖ GitHub ÂÜÖÂÆπÂ∑≤Âä†ËΩΩ„ÄÇ";
      } catch (err) {
        document.getElementById("status").textContent = "‚ùå Âä†ËΩΩÂ§±Ë¥•Ôºö" + err.message;
        editMode();
      }
    }

    // ‰∫ã‰ª∂ÁõëÂê¨
    textarea.addEventListener("input", updateWordCount);

    // --- ‰øÆÂ§çÁÇπ 2 (Êé®Ëçê): ÁªëÂÆöÁÇπÂáª‰∫ã‰ª∂ ---
    document.getElementById('settingsBtn').addEventListener('click', toggleSettings);

    // ËÆæÁΩÆÂèòÊõ¥ÁõëÂê¨
    document.addEventListener("change", (e) => {
      if (e.target.type === "radio") {
        const name = e.target.name;
        const value = e.target.value;

        if (name === "theme") {
          localStorage.setItem("app_theme", value);
          document.body.setAttribute("data-theme", value);
        } else if (name === "font") {
          localStorage.setItem("app_font", value);
          document.body.setAttribute("data-font", value);
        } else if (name === "size") {
          localStorage.setItem("app_size", value);
          document.body.setAttribute("data-size", value);
        }
      }
    });

    // ÈîÆÁõòÂø´Êç∑ÈîÆ
    document.addEventListener("keydown", (e) => {
      if (e.ctrlKey && e.key === "s") {
        e.preventDefault();
        submitContent();
      } else if (e.key === "Escape") {
        closeSettings();
      }
    });

    // Token ËæìÂÖ•Ê°ÜÂõûËΩ¶Êèê‰∫§
    document.getElementById("tokenInput").addEventListener("keydown", (e) => {
      if (e.key === "Enter") {
        saveToken();
      }
    });

    // ÂàùÂßãÂåñ
    window.onload = () => {
      initSettings();
      ensureToken();
      if (GITHUB_TOKEN) loadContent();
      updateWordCount();
    };
  </script>
</body>
</html>
