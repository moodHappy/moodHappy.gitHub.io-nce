<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Reader é€šç”¨åº“æµ‹è¯•</title>

    <link rel="stylesheet" href="https://unpkg.com/tippy.js@6/animations/shift-away.css"/>
    <link rel="stylesheet" href="https://unpkg.com/tippy.js@6/themes/light-border.css"/>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/moodHappy/HelloWorld@master/Notes/ai-reader.css">

    <style>
        /* --- é¡µé¢åŸºç¡€æ ·å¼ --- */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            line-height: 1.8;
            color: #333;
            background-color: #f9f9f9;
            margin: 0;
            padding: 20px;
        }

        header { margin-bottom: 30px; text-align: center; }

        .container {
            max-width: 700px;
            margin: 0 auto;
            background: #ffffff;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        p { margin-bottom: 24px; font-size: 18px; text-align: justify; }

        /* --- å³ä¸Šè§’é½¿è½®æŒ‰é’®æ ·å¼ --- */
        .settings-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #fff;
            border: 1px solid #ddd;
            font-size: 20px;
            color: #666;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            z-index: 1000;
            outline: none;
        }
        .settings-btn:hover {
            transform: rotate(90deg);
            background-color: #f0f0f0;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        /* Key å·²ä¿å­˜æ—¶çš„æ ·å¼ï¼ˆç»¿è‰²ï¼‰ */
        .settings-btn.has-key {
            border-color: #b7eb8f;
            color: #52c41a;
            background-color: #f6ffed;
        }

        /* --- è®¾ç½®å¼¹çª— (Settings Modal) æ ·å¼ --- */
        .settings-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5); backdrop-filter: blur(2px);
            display: none; /* é»˜è®¤éšè— */
            justify-content: center; align-items: center; z-index: 2000;
            opacity: 0; transition: opacity 0.3s;
        }
        .settings-overlay.active { display: flex; opacity: 1; }

        .settings-card {
            background: white; padding: 25px; border-radius: 12px;
            width: 90%; max-width: 450px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            transform: scale(0.95); transition: transform 0.3s;
        }
        .settings-overlay.active .settings-card { transform: scale(1); }

        .settings-card h2 { margin: 0 0 20px 0; font-size: 18px; color: #333; border-bottom: 1px solid #eee; padding-bottom: 10px; }
        
        .settings-group { margin-bottom: 15px; }
        .settings-group label { display: block; font-size: 14px; font-weight: 500; color: #555; margin-bottom: 5px; }
        .settings-group input {
            width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px;
            font-size: 14px; box-sizing: border-box; transition: border-color 0.2s; font-family: monospace;
        }
        .settings-group input:focus { border-color: #1976D2; outline: none; }
        .settings-group input::placeholder { color: #ccc; }
        .settings-group .desc { font-size: 11px; color: #888; margin-top: 3px; }

        .btn-row { display: flex; justify-content: flex-end; gap: 10px; margin-top: 25px; }
        .btn-save { background: #1976D2; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-weight: 500; }
        .btn-save:hover { background: #1565C0; }
        .btn-cancel { background: #f5f5f5; color: #333; border: 1px solid #ddd; padding: 10px 20px; border-radius: 6px; cursor: pointer; }
        .btn-cancel:hover { background: #e0e0e0; }

    </style>
</head>
<body>

    <button id="configBtn" class="settings-btn" onclick="openSettings()" title="è®¾ç½® API å’Œ è¯è¡¨é“¾æ¥">
        âš™ï¸
    </button>

    <header>
        <h1>é˜…è¯»åŠ©æ‰‹é€šç”¨æ¨¡æ¿</h1>
    </header>

    <div class="container" id="content-area">

        <p>As the sun set over the quiet streets of Salisbury, a chill ran down the spine of the city's residents. It had been years since the fateful day when Sergei Skripal, a former Russian spy, and his daughter Yulia were poisoned with Novichok, a deadly nerve agent. The incident had sent shockwaves through the community, and the memory of it still lingered like an open wound.</p>

        <p>President Vladimir Putin has warned again that Ukrainian troops must withdraw from Ukraine's eastern Donbas region or Russia will seize it, rejecting any compromise over how to end the war in Ukraine.</p>

        <p>"Either we liberate these territories by force, or Ukrainian troops will leave these territories," he told India Today. Moscow controls around 85% of Donbas.</p>

        <p>Ukrainian President Volodymyr Zelensky has ruled out ceding territory.</p>

        <p>Putin's comments come after President Donald Trump said his negotiators discussing a US peace plan believed Russia's leader "would like to end the war" after Tuesday's talks in Moscow.</p>

        <p>Trump's envoy Steve Witkoff, who was in Moscow, is due to meet Ukraine's team in Florida.</p>

    </div>

    <div id="settingsModal" class="settings-overlay">
        <div class="settings-card">
            <h2>âš™ï¸ é…ç½®ä¸­å¿ƒ</h2>
            
            <div class="settings-group">
                <label>Groq API Key</label>
                <input type="password" id="cfg_key" placeholder="sk-..." autocomplete="off">
            </div>

            <div class="settings-group">
                <label>ğŸ”´ çº¢è‰²é«˜äº®è¯è¡¨é“¾æ¥ (Red)</label>
                <input type="text" id="cfg_red" placeholder="ä¾‹å¦‚: .../Notes/two.txt">
                <div class="desc">å¡«å…¥ txt æ–‡ä»¶ç›´é“¾ï¼Œæ¯è¡Œä¸€ä¸ªå•è¯ï¼Œæ˜¾ç¤ºä¸ºçº¢è‰²ã€‚</div>
            </div>

            <div class="settings-group">
                <label>ğŸ”µ è“è‰²é«˜äº®è¯è¡¨é“¾æ¥ (Blue)</label>
                <input type="text" id="cfg_blue" placeholder="ä¾‹å¦‚: .../Notes/one.txt">
                <div class="desc">å¡«å…¥ txt æ–‡ä»¶ç›´é“¾ï¼Œæ¯è¡Œä¸€ä¸ªå•è¯ï¼Œæ˜¾ç¤ºä¸ºè“è‰²ã€‚</div>
            </div>

            <div class="settings-group">
                <label>âšª æ’é™¤è¯è¡¨é“¾æ¥ (Exclude)</label>
                <input type="text" id="cfg_ex" placeholder="ä¾‹å¦‚: .../Notes/Excluded.txt">
                <div class="desc">æ­¤åˆ—è¡¨ä¸­çš„å•è¯å°†ä¸ä¼šè¢«é«˜äº®ã€‚</div>
            </div>

            <div class="btn-row">
                <button class="btn-cancel" onclick="closeSettings()">å–æ¶ˆ</button>
                <button class="btn-save" onclick="saveSettings()">ä¿å­˜å¹¶åˆ·æ–°</button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://unpkg.com/@popperjs/core@2"></script>
    <script src="https://unpkg.com/tippy.js@6"></script>
    <script src="https://unpkg.com/compromise@14.10.0/builds/compromise.min.js"></script>

    <script src="https://cdn.jsdelivr.net/gh/moodHappy/HelloWorld@master/Notes/ai-reader.js"></script>

    <script>
        // --- è®¾ç½®é¢æ¿é€»è¾‘ ---

        // å®šä¹‰ LocalStorage çš„é”®å
        const KEYS = {
            API: 'groq_api_key',
            RED: 'highlight_url_red',
            BLUE: 'highlight_url_blue',
            EXCLUDE: 'highlight_url_exclude'
        };

        // æ‰“å¼€è®¾ç½®å¼¹çª—
        function openSettings() {
            const modal = document.getElementById('settingsModal');
            
            // è¯»å–å·²ä¿å­˜çš„å€¼å¡«å……è¾“å…¥æ¡†
            document.getElementById('cfg_key').value = localStorage.getItem(KEYS.API) || '';
            document.getElementById('cfg_red').value = localStorage.getItem(KEYS.RED) || '';
            document.getElementById('cfg_blue').value = localStorage.getItem(KEYS.BLUE) || '';
            document.getElementById('cfg_ex').value = localStorage.getItem(KEYS.EXCLUDE) || '';

            modal.classList.add('active');
        }

        // å…³é—­è®¾ç½®å¼¹çª—
        function closeSettings() {
            document.getElementById('settingsModal').classList.remove('active');
        }

        // ä¿å­˜å¹¶åˆ·æ–°
        function saveSettings() {
            const key = document.getElementById('cfg_key').value.trim();
            const red = document.getElementById('cfg_red').value.trim();
            const blue = document.getElementById('cfg_blue').value.trim();
            const ex = document.getElementById('cfg_ex').value.trim();

            if (key) localStorage.setItem(KEYS.API, key);
            else localStorage.removeItem(KEYS.API);

            if (red) localStorage.setItem(KEYS.RED, red);
            else localStorage.removeItem(KEYS.RED);

            if (blue) localStorage.setItem(KEYS.BLUE, blue);
            else localStorage.removeItem(KEYS.BLUE);

            if (ex) localStorage.setItem(KEYS.EXCLUDE, ex);
            else localStorage.removeItem(KEYS.EXCLUDE);

            alert("è®¾ç½®å·²ä¿å­˜ï¼é¡µé¢å°†åˆ·æ–°ä»¥åº”ç”¨æ›´æ”¹ã€‚");
            location.reload();
        }

        // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥ Key çŠ¶æ€ï¼Œæ”¹å˜é½¿è½®æ ·å¼
        document.addEventListener('DOMContentLoaded', () => {
            const btn = document.getElementById('configBtn');
            if(localStorage.getItem(KEYS.API)) {
                btn.classList.add('has-key');
            }
        });

        // --- å¯åŠ¨ AIReader ---
        document.addEventListener('DOMContentLoaded', () => {
            // è¿™é‡Œä¸å†å†™æ­»é“¾æ¥ï¼Œè€Œæ˜¯ç›´æ¥ä» LocalStorage è¯»å–
            // å¦‚æœç”¨æˆ·è¿˜æ²¡å¡«ï¼Œé»˜è®¤ä¸ºç©ºå­—ç¬¦ä¸²ï¼ŒAIReader ä¸ä¼šæŠ¥é”™åªæ˜¯ä¸é«˜äº®
            new AIReader({
                containerSelector: '#content-area', 
                blueUrl: localStorage.getItem(KEYS.BLUE) || '',
                redUrl: localStorage.getItem(KEYS.RED) || '',
                excludeUrl: localStorage.getItem(KEYS.EXCLUDE) || ''
            });
            console.log("AI Reader å·²å¯åŠ¨ (ä½¿ç”¨è‡ªå®šä¹‰é…ç½®)");
        });
    </script>
</body>
</html>