<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global News Archive (å®æ—¶ç‰ˆ)</title>



    <link rel="icon" type="image/png" href="https://raw.githubusercontent.com/moodHappy/moodHappy.gitHub.io-nce/refs/heads/main/icon/news_history.png">

    <link rel="apple-touch-icon" href="https://raw.githubusercontent.com/moodHappy/moodHappy.gitHub.io-nce/refs/heads/main/icon/news_history.png">




    <link href="https://fonts.googleapis.com/css2?family=Merriweather:ital,wght@0,400;0,700;1,400&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        /* === è¯·åœ¨æ­¤å¤„ç²˜è´´ä¹‹å‰æä¾›çš„ CSS ä»£ç  === */
        :root { --bg-body: #f0f2f5; --bg-card: #ffffff; --bg-control: #ffffff; --text-primary: #1a1a1a; --text-secondary: #65676b; --accent-color: #2563eb; --border-color: #e4e6eb; --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05); --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.08); --shadow-hover: 0 12px 24px rgba(0, 0, 0, 0.12); --badge-bg: #f3f4f6; }
        @media (prefers-color-scheme: dark) { :root { --bg-body: #18191a; --bg-card: #242526; --bg-control: #242526; --text-primary: #e4e6eb; --text-secondary: #b0b3b8; --accent-color: #4a90e2; --border-color: #3e4042; --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.2); --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.3); --shadow-hover: 0 12px 24px rgba(0, 0, 0, 0.4); --badge-bg: #3a3b3c; } }
        body { font-family: 'Inter', sans-serif; background-color: var(--bg-body); color: var(--text-primary); margin: 0; padding: 40px 20px; transition: background 0.3s, color 0.3s; }
        .container { max-width: 1000px; margin: 0 auto; }
        header { text-align: center; margin-bottom: 40px; }
        h1 { font-family: 'Merriweather', serif; font-size: 2.5rem; margin-bottom: 10px; letter-spacing: -0.5px; }
        .subtitle { color: var(--text-secondary); font-size: 1rem; font-family: 'Inter', sans-serif; }
        .controls { background: var(--bg-control); padding: 24px; border-radius: 16px; box-shadow: var(--shadow-md); margin-bottom: 30px; border: 1px solid var(--border-color); }
        .controls-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        select { padding: 8px 16px; font-size: 16px; border-radius: 8px; border: 1px solid var(--border-color); background-color: var(--bg-body); color: var(--text-primary); cursor: pointer; outline: none; }
        .months-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(60px, 1fr)); gap: 8px; }
        .month-btn { padding: 10px 0; background: transparent; border: 1px solid transparent; border-radius: 8px; cursor: pointer; transition: all 0.2s; font-size: 14px; color: var(--text-secondary); font-weight: 500; }
        .month-btn:hover { background-color: var(--bg-body); color: var(--text-primary); }
        .month-btn.active { background-color: var(--accent-color); color: white; box-shadow: 0 2px 8px rgba(37, 99, 235, 0.3); }
        #news-container { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; min-height: 300px; }
        .news-item { background: var(--bg-card); border-radius: 12px; padding: 24px; box-shadow: var(--shadow-sm); border: 1px solid var(--border-color); transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1); display: flex; flex-direction: column; justify-content: space-between; position: relative; overflow: hidden; }
        .news-item::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 4px; background: var(--accent-color); opacity: 0; transition: opacity 0.3s; }
        .news-item:hover { transform: translateY(-5px); box-shadow: var(--shadow-hover); border-color: transparent; }
        .news-item:hover::before { opacity: 1; }
        .news-title { margin: 0 0 16px 0; font-family: 'Merriweather', serif; font-size: 1.15em; line-height: 1.5; font-weight: 700; }
        .news-title a { text-decoration: none; color: var(--text-primary); display: block; display: -webkit-box; -webkit-line-clamp: 4; -webkit-box-orient: vertical; overflow: hidden; }
        .news-title a:hover { color: var(--accent-color); }
        .news-meta { margin-top: 15px; padding-top: 15px; border-top: 1px solid var(--border-color); display: flex; flex-wrap: wrap; gap: 8px; font-size: 0.75em; }
        .badge { background-color: var(--badge-bg); color: var(--text-secondary); padding: 4px 10px; border-radius: 20px; display: inline-flex; align-items: center; font-weight: 500; }
        .status-msg { grid-column: 1 / -1; text-align: center; padding: 60px; color: var(--text-secondary); font-size: 1.1em; background: var(--bg-card); border-radius: 12px; border: 1px dashed var(--border-color); word-break: break-all; }
        .error-msg { color: #ef4444; border-color: #ef4444; background: rgba(239, 68, 68, 0.05); }
        .debug-url { display: block; margin-top: 15px; padding: 10px; background: rgba(0,0,0,0.05); border-radius: 6px; font-family: monospace; font-size: 0.85em; color: var(--text-primary); }
        .spinner { width: 40px; height: 40px; border: 3px solid var(--border-color); border-radius: 50%; border-top-color: var(--accent-color); animation: spin 0.8s ease-in-out infinite; margin: 0 auto 15px auto; }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>Global News Archive</h1>
            <div class="subtitle">å†å²ä¸æœªæ¥çš„è§è¯ | 2025 - 2054</div>
        </header>

        <div class="controls">
            <div class="controls-header">
                <span style="font-weight:600; font-size:1.1em">ğŸ“… é€‰æ‹©å¹´ä»½</span>
                <select id="year-select" disabled>
                    <option>æ­£åœ¨æ£€æŸ¥æ›´æ–°...</option>
                </select>
            </div>
            <div class="months-grid" id="month-container"></div>
        </div>

        <div id="news-container">
            <div class="status-msg">
                <div class="spinner"></div>
                æ­£åœ¨åŒæ­¥æœ€æ–°ç‰ˆæœ¬...
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // æ ¸å¿ƒé…ç½®ï¼šGithub ä»“åº“ä¿¡æ¯
        // ============================================
        const GITHUB_USER = 'moodHappy';
        const GITHUB_REPO = 'HelloWorld';
        const GITHUB_BRANCH = 'master'; // ä½ çš„ä¸»åˆ†æ”¯å

        const yearSelect = document.getElementById('year-select');
        const monthContainer = document.getElementById('month-container');
        const newsContainer = document.getElementById('news-container');

        // å…¨å±€å˜é‡ï¼Œç”¨äºå­˜å‚¨æœ€æ–°çš„ Commit SHA
        let LATEST_SHA = 'master'; 

        // 1. ç¨‹åºå…¥å£ï¼šè·å–æœ€æ–° Commitï¼Œè§£å†³ç¼“å­˜é—®é¢˜
        async function startApp() {
            try {
                // è¯·æ±‚ Github API è·å– master åˆ†æ”¯çš„æœ€æ–°ä¿¡æ¯
                const response = await fetch(`https://api.github.com/repos/${GITHUB_USER}/${GITHUB_REPO}/commits/${GITHUB_BRANCH}`);
                
                if (response.ok) {
                    const data = await response.json();
                    LATEST_SHA = data.sha; // æ‹¿åˆ°æœ€æ–°çš„å“ˆå¸Œå€¼ï¼Œä¾‹å¦‚ "7b3f1..."
                    console.log('æ£€æµ‹åˆ°æœ€æ–°ç‰ˆæœ¬:', LATEST_SHA);
                } else {
                    console.warn('APIé™æµæˆ–ç½‘ç»œé”™è¯¯ï¼Œé™çº§ä½¿ç”¨ master (å¯èƒ½æœ‰ç¼“å­˜)');
                }
            } catch (e) {
                console.warn('ç‰ˆæœ¬æ£€æµ‹å¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤æ¨¡å¼');
            }

            // æ— è®ºè·å–æˆåŠŸä¸å¦ï¼Œéƒ½å¼€å§‹åŠ è½½ Config
            loadRemoteConfig();
        }

        // 2. åŠ è½½è¿œç¨‹é…ç½® (ä½¿ç”¨ SHA åŠ¨æ€æ„å»º URL)
        function loadRemoteConfig() {
            // ä½¿ç”¨ SHA æ„å»º URLï¼Œç¡®ä¿ Config ä¹Ÿæ˜¯æœ€æ–°çš„
            const configUrl = `https://cdn.jsdelivr.net/gh/${GITHUB_USER}/${GITHUB_REPO}@${LATEST_SHA}/Notes/News.js`;
            
            fetch(configUrl)
                .then(response => {
                    if (!response.ok) throw new Error("æ— æ³•è¿æ¥åˆ° CDN é…ç½®æ–‡ä»¶");
                    return response.text();
                })
                .then(scriptContent => {
                    const blob = new Blob([scriptContent], { type: 'application/javascript' });
                    const url = URL.createObjectURL(blob);
                    const script = document.createElement('script');
                    script.src = url;
                    script.onload = () => { 
                        initApp(); 
                        URL.revokeObjectURL(url); 
                    };
                    document.head.appendChild(script);
                })
                .catch(error => {
                    newsContainer.innerHTML = `<div class="status-msg error-msg"><h3>âš ï¸ åŠ è½½å¤±è´¥</h3><p>${error.message}</p></div>`;
                });
        }

        // 3. åˆå§‹åŒ–åº”ç”¨
        function initApp() {
            if (typeof NewsConfig === 'undefined') return;

            // â˜…â˜…â˜… å…³é”®ä¸€æ­¥ï¼šå¼ºåˆ¶è¦†ç›– Config ä¸­çš„ BaseUrl â˜…â˜…â˜…
            // è®©åç»­è¯»å– Markdown æ–‡ä»¶ä¹Ÿä½¿ç”¨è¿™ä¸ªæœ€æ–°çš„ SHA
            NewsConfig.repoBaseUrl = `https://cdn.jsdelivr.net/gh/${GITHUB_USER}/${GITHUB_REPO}@${LATEST_SHA}/Notes/News/`;

            yearSelect.disabled = false;
            yearSelect.innerHTML = '';
            populateYears();

            const today = new Date();
            let defaultYear = NewsConfig.startYear;
            if (today.getFullYear() >= NewsConfig.startYear && today.getFullYear() < NewsConfig.startYear + NewsConfig.totalYears) {
                defaultYear = today.getFullYear();
            }

            yearSelect.value = defaultYear;
            loadMonthsForYear(defaultYear);

            // è‡ªåŠ¨ç‚¹å‡»é€»è¾‘
            const targetMonth = (defaultYear === today.getFullYear()) ? (today.getMonth() + 1) : 12;
            setTimeout(() => {
                const btn = document.querySelector(`button[data-month="${targetMonth}"]`) || document.querySelector(`button[data-month="12"]`);
                if(btn) btn.click();
            }, 100);
        }

        // ... (ä»¥ä¸‹æ˜¯æ ‡å‡†çš„ UI é€»è¾‘ï¼Œä¸ä¹‹å‰ç›¸åŒ) ...
        function populateYears() {
            const start = NewsConfig.startYear;
            for (let y = start; y < start + NewsConfig.totalYears; y++) {
                const option = document.createElement('option');
                option.value = y;
                option.text = `${y}å¹´`;
                yearSelect.appendChild(option);
            }
            yearSelect.addEventListener('change', (e) => loadMonthsForYear(parseInt(e.target.value)));
        }

        function loadMonthsForYear(year) {
            monthContainer.innerHTML = '';
            for (let m = 1; m <= 12; m++) {
                const btn = document.createElement('button');
                btn.className = 'month-btn';
                btn.innerText = `${m}æœˆ`;
                btn.dataset.month = m;
                btn.onclick = () => {
                    document.querySelectorAll('.month-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    fetchNews(year, m);
                };
                monthContainer.appendChild(btn);
            }
        }

        function fetchNews(year, month) {
            const targetUrl = NewsConfig.getUrl(year, month);
            
            newsContainer.innerHTML = `<div class="status-msg"><div class="spinner"></div>è¯»å–ä¸­: ${year}-${month}</div>`;

            fetch(targetUrl)
                .then(response => {
                    if (!response.ok) throw new Error('CDN æ–‡ä»¶æœªæ‰¾åˆ° (404)');
                    return response.text();
                })
                .then(text => {
                    if (!text.trim()) throw new Error('æ–‡ä»¶å†…å®¹ä¸ºç©º');
                    const items = parseMarkdown(text);
                    renderItems(items);
                })
                .catch(error => {
                    newsContainer.innerHTML = `
                        <div class="status-msg error-msg">
                            <strong>æ— æ³•åŠ è½½å½’æ¡£</strong><br>
                            <small>${error.message}</small>
                            <br>
                            <span class="debug-url">${targetUrl}</span>
                        </div>`;
                });
        }

        function parseMarkdown(text) {
            const lines = text.split('\n');
            const items = [];
            let currentItem = null;
            lines.forEach(line => {
                line = line.trim();
                const titleMatch = line.match(/^###\s*\[(.*?)\]\((.*)\)/);
                if (titleMatch) {
                    if (currentItem) items.push(currentItem);
                    currentItem = { title: titleMatch[1], link: titleMatch[2], date: '', id: '' };
                } else if (currentItem) {
                    const dateMatch = line.match(/^- \*\*Date\*\*: (.*)/);
                    if (dateMatch) currentItem.date = dateMatch[1];
                    const idMatch = line.match(/^- \*\*ID\*\*: (.*)/);
                    if (idMatch) currentItem.id = idMatch[1];
                }
            });
            if (currentItem) items.push(currentItem);
            return items;
        }

        function renderItems(items) {
            newsContainer.innerHTML = '';
            if (items.length === 0) {
                newsContainer.innerHTML = '<div class="status-msg">æ²¡æœ‰æ‰¾åˆ°æ¡ç›®</div>';
                return;
            }
            items.forEach(item => {
                const div = document.createElement('div');
                div.className = 'news-item';
                div.innerHTML = `
                    <h2 class="news-title">
                        <a href="${item.link}" target="_blank" title="${item.title}">${item.title}</a>
                    </h2>
                    <div class="news-meta">
                        <span class="badge">ğŸ“… ${item.date || '---'}</span>
                        <span class="badge">ğŸ†” ${item.id ? item.id.slice(-6) : '---'}</span> 
                    </div>
                `;
                newsContainer.appendChild(div);
            });
        }

        // å¯åŠ¨ï¼
        startApp();
    </script>
</body>
</html>
