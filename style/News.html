<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æœªæ¥30å¹´æ–°é—»å½’æ¡£ (2025-2054)</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --accent-color: #007bff; /* æ”¹å›äº®è“è‰²ï¼Œæ›´åƒé“¾æ¥ */
            --bg-color: #f8f9fa;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: #333;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        /* é¡¶éƒ¨æ§åˆ¶æ  */
        .controls {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            margin-bottom: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .year-selector-group {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.1em;
            font-weight: bold;
        }

        select {
            padding: 8px 12px;
            font-size: 16px;
            border-radius: 6px;
            border: 1px solid #ddd;
            background-color: #fff;
            cursor: pointer;
        }

        .months-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(60px, 1fr));
            gap: 10px;
            border-top: 1px solid #eee;
            padding-top: 15px;
        }

        .month-btn {
            padding: 8px 0;
            background: white;
            border: 1px solid #ddd;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
            color: #555;
        }

        .month-btn:hover { background-color: #f1f1f1; border-color: #bbb; }
        
        .month-btn.active {
            background-color: var(--accent-color);
            color: white;
            border-color: var(--accent-color);
            font-weight: bold;
            box-shadow: 0 2px 4px rgba(0, 123, 255, 0.3);
        }

        /* å†…å®¹å±•ç¤ºåŒº */
        #news-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            min-height: 300px;
        }

        /* æ ¸å¿ƒä¿®æ”¹ï¼šè®©Aæ ‡ç­¾åŒ…è£¹æ•´ä¸ªå¡ç‰‡ï¼Œå¹¶å»é™¤Aæ ‡ç­¾çš„é»˜è®¤ä¸‹åˆ’çº¿ */
        .news-card-link {
            text-decoration: none;
            color: inherit;
            display: block; /* è®©é“¾æ¥å˜æˆå—çº§å…ƒç´  */
        }

        .news-item {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            border-left: 5px solid var(--accent-color);
            transition: transform 0.2s, box-shadow 0.2s;
            animation: slideIn 0.3s ease-out;
            cursor: pointer; /* é¼ æ ‡æ”¾ä¸Šå»å˜æˆæ‰‹å‹ */
        }

        /* æ‚¬åœæ•ˆæœï¼šæ•´ä¸ªå¡ç‰‡æµ®èµ· */
        .news-card-link:hover .news-item {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            background-color: #fafcff;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .news-title { 
            margin: 0 0 10px 0; 
            font-size: 1.25em;
            color: #2c3e50;
            font-weight: bold;
        }

        /* æ ‡é¢˜æ‚¬åœå˜è‰² */
        .news-card-link:hover .news-title {
            color: var(--accent-color);
            text-decoration: underline;
        }

        .news-meta {
            font-size: 0.85em;
            color: #7f8c8d;
            display: flex;
            gap: 15px;
            margin-top: 8px;
        }

        .status-msg {
            text-align: center;
            padding: 40px;
            color: #7f8c8d;
            font-size: 1.1em;
        }
        .error-msg { color: #e74c3c; }
        
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--accent-color);
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

    </style>
</head>
<body>

    <h1 style="text-align: center; color: var(--primary-color);">ğŸ—ï¸ å†å²ä¸æœªæ¥æ–°é—»å½’æ¡£</h1>

    <div class="controls">
        <div class="year-selector-group">
            <label for="year-select">é€‰æ‹©å¹´ä»½:</label>
            <select id="year-select" disabled>
                <option>åŠ è½½ä¸­...</option>
            </select>
        </div>

        <div class="months-grid" id="month-container"></div>
    </div>

    <div id="news-container">
        <div class="status-msg">
            <div class="spinner"></div>
            æ­£åœ¨åŒæ­¥è¿œç¨‹é…ç½®æ–‡ä»¶...
        </div>
    </div>

    <script>
        // è¿œç¨‹ Config åœ°å€
        const REMOTE_CONFIG_URL = 'https://raw.githubusercontent.com/moodHappy/HelloWorld/refs/heads/master/Notes/News.js';

        const yearSelect = document.getElementById('year-select');
        const monthContainer = document.getElementById('month-container');
        const newsContainer = document.getElementById('news-container');

        // åŠ è½½è¿œç¨‹é…ç½®
        function loadRemoteConfig() {
            const timestamp = new Date().getTime();
            const proxyUrl = 'https://api.allorigins.win/raw?url=' + encodeURIComponent(REMOTE_CONFIG_URL) + '&t=' + timestamp;

            fetch(proxyUrl)
                .then(r => {
                    if (!r.ok) throw new Error("æ— æ³•ä¸‹è½½é…ç½®æ–‡ä»¶");
                    return r.text();
                })
                .then(scriptContent => {
                    const blob = new Blob([scriptContent], { type: 'application/javascript' });
                    const url = URL.createObjectURL(blob);
                    const script = document.createElement('script');
                    script.src = url;
                    script.onload = () => {
                        initApp();
                        URL.revokeObjectURL(url);
                    };
                    script.onerror = () => { throw new Error("é…ç½®æ–‡ä»¶è§£æå¤±è´¥"); };
                    document.head.appendChild(script);
                })
                .catch(error => {
                    newsContainer.innerHTML = `<div class="status-msg error-msg">${error.message}</div>`;
                });
        }

        // åˆå§‹åŒ–
        function initApp() {
            if (typeof NewsConfig === 'undefined') return;

            yearSelect.disabled = false;
            yearSelect.innerHTML = '';
            populateYears();
            
            const today = new Date();
            const currentYear = today.getFullYear();
            const currentMonth = today.getMonth() + 1;
            
            let defaultYear = NewsConfig.startYear;
            if (currentYear >= NewsConfig.startYear && currentYear < NewsConfig.startYear + NewsConfig.totalYears) {
                defaultYear = currentYear;
            }

            yearSelect.value = defaultYear;
            loadMonthsForYear(defaultYear);

            const monthToClick = (defaultYear === currentYear) ? currentMonth : 12;
            const targetBtn = document.querySelector(`button[data-month="${monthToClick}"]`);
            if (targetBtn) targetBtn.click();
            else {
                 const lastBtn = document.querySelector(`button[data-month="12"]`);
                 if(lastBtn) lastBtn.click();
            }
        }

        function populateYears() {
            const start = NewsConfig.startYear;
            const end = start + NewsConfig.totalYears;
            for (let y = start; y < end; y++) {
                const option = document.createElement('option');
                option.value = y;
                option.text = `${y}å¹´`;
                yearSelect.appendChild(option);
            }
            yearSelect.addEventListener('change', (e) => loadMonthsForYear(parseInt(e.target.value)));
        }

        function loadMonthsForYear(year) {
            monthContainer.innerHTML = '';
            for (let m = 1; m <= 12; m++) {
                const btn = document.createElement('button');
                btn.className = 'month-btn';
                btn.innerText = `${m}æœˆ`;
                btn.dataset.month = m;
                btn.onclick = () => {
                    document.querySelectorAll('.month-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    fetchNews(year, m);
                };
                monthContainer.appendChild(btn);
            }
        }

        function fetchNews(year, month) {
            const targetUrl = NewsConfig.getUrl(year, month);
            newsContainer.innerHTML = `<div class="status-msg"><div class="spinner"></div>æ­£åœ¨è¯»å–æ¡£æ¡ˆ...</div>`;
            
            fetch('https://api.allorigins.win/raw?url=' + encodeURIComponent(targetUrl))
                .then(r => { if (!r.ok) throw new Error('404'); return r.text(); })
                .then(text => {
                    if (!text.trim()) throw new Error('Empty');
                    renderItems(parseMarkdown(text));
                })
                .catch(e => {
                    let msg = `æœªæ‰¾åˆ° ${year}å¹´${month}æœˆ çš„å½’æ¡£ã€‚`;
                    if (NewsConfig.manualOverrides[`${year}-${month.toString().padStart(2,'0')}`]) msg = `é…ç½®çš„é“¾æ¥æ— æ•ˆã€‚`;
                    newsContainer.innerHTML = `<div class="status-msg">${msg}</div>`;
                });
        }

        // æ ¸å¿ƒä¿®æ”¹ï¼šæ­£åˆ™ç¨å¾®æ”¾å®½ä¸€ç‚¹ï¼Œå…è®¸ ### åé¢æœ‰å¤šä¸ªç©ºæ ¼
        function parseMarkdown(text) {
            const lines = text.split('\n');
            const items = [];
            let currentItem = null;

            lines.forEach(line => {
                line = line.trim();
                // å…è®¸ ### åæœ‰ä¸€ä¸ªæˆ–å¤šä¸ªç©ºæ ¼ \s+
                const titleMatch = line.match(/^###\s+\[(.*?)\]\((.*?)\)/);
                if (titleMatch) {
                    if (currentItem) items.push(currentItem);
                    currentItem = { title: titleMatch[1], link: titleMatch[2], date: '', id: '' };
                } else if (currentItem) {
                    const dateMatch = line.match(/^- \*\*Date\*\*: (.*)/);
                    if (dateMatch) currentItem.date = dateMatch[1];
                    const idMatch = line.match(/^- \*\*ID\*\*: (.*)/);
                    if (idMatch) currentItem.id = idMatch[1];
                }
            });
            if (currentItem) items.push(currentItem);
            return items;
        }

        // æ ¸å¿ƒä¿®æ”¹ï¼šæ¸²æŸ“æ—¶ï¼Œç”¨ <a> åŒ…è£¹æ•´ä¸ªå¡ç‰‡
        function renderItems(items) {
            newsContainer.innerHTML = '';
            if (items.length === 0) {
                newsContainer.innerHTML = '<div class="status-msg">è§£ææˆåŠŸï¼Œä½†æ²¡æœ‰æ¡ç›®ã€‚</div>';
                return;
            }
            items.forEach(item => {
                // åˆ›å»ºä¸€ä¸ªå¤§çš„é“¾æ¥å®¹å™¨
                const linkWrapper = document.createElement('a');
                linkWrapper.className = 'news-card-link';
                linkWrapper.href = item.link;
                linkWrapper.target = "_blank"; // åœ¨æ–°æ ‡ç­¾é¡µæ‰“å¼€
                
                // å†…éƒ¨æ˜¯ä¹‹å‰çš„ news-item ç»“æ„
                linkWrapper.innerHTML = `
                    <div class="news-item">
                        <div class="news-title">${item.title}</div>
                        <div class="news-meta">
                            <span>ğŸ“… ${item.date || 'æœªçŸ¥æ—¥æœŸ'}</span>
                            <span>ğŸ†” ${item.id || 'N/A'}</span>
                        </div>
                    </div>
                `;
                
                newsContainer.appendChild(linkWrapper);
            });
        }

        loadRemoteConfig();
    </script>
</body>
</html>
